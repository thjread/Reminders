import m from "mithril";
import {store, getTodo} from "../models/store";
import {toggleDone} from "../models/actions";
import {formatDateTime} from "../utils";

interface Attrs {
    id: string;
    selectCallback: (id: string) => void;
    selected: boolean;
}

const Item: m.Component<Attrs> = {
    view: function(vnode) {
        const id = vnode.attrs.id;
        const item = getTodo(id);

        return m("li.item",
                 { onclick: selectCallback(id) }
            m("label.item-main", {for: id}, [
                m("input[type=checkbox]",
                  {checked: item.done,
                   id: id,
                   oninput: (e: any) => store.dispatch(toggleDone(id, e.target.checked))}),
                m("div.css-check"),
                m("h2.item-title", item.title),
                m("h2.item-deadline", item.deadline ? m("h3.item-deadline", formatDateTime(item.deadline)) : undefined)
            ])
        );
    }
};

export default Item;
